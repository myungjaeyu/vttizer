!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Vttizer=e()}(this,function(){"use strict";var t=t=>{let e=[];t.split("\n").slice(1).join("\n").replace(/\r+/g,"").replace(/^\s+|\s+$/g,"").split("\n\n").forEach(t=>{let n=t.split(/\n/).filter(t=>t),r=n[1].match(/(\d+):(\d+):(\d+)(?:.(\d+))?\s*--?>\s*(\d+):(\d+):(\d+)(?:.(\d+))?/);e.push({id:n[0],start:60*parseInt(r[1],10)*60+60*parseInt(r[2],10)+parseInt(r[3],10)+parseInt(r[4],10)/1e3,end:60*parseInt(r[5],10)*60+60*parseInt(r[6],10)+parseInt(r[7],10)+parseInt(r[8],10)/1e3,text:n.filter((t,e)=>e>1).join("\n")})});return e},e=t=>{let e=[];t.replace(/\r+/g,"").replace(/^\s+|\s+$/g,"").split("\n\n").forEach(t=>{let n=t.split(/\n/).filter(t=>t),r=n[1].match(/(\d+):(\d+):(\d+)(?:,(\d+))?\s*--?>\s*(\d+):(\d+):(\d+)(?:,(\d+))?/);e.push({id:n[0],start:60*parseInt(r[1],10)*60+60*parseInt(r[2],10)+parseInt(r[3],10)+parseInt(r[4],10)/1e3,end:60*parseInt(r[5],10)*60+60*parseInt(r[6],10)+parseInt(r[7],10)+parseInt(r[8],10)/1e3,text:n.filter((t,e)=>e>1).join("\n")})});return e},n=t=>{let e=[];let n=t.replace(/(\r\n|\n|\r)/gm,"").match(/(<SYNC[^]*?)(?=\s*<SYNC|\s*<\/BODY)/gi).map(t=>[+t.split("><")[0].replace("<SYNC Start=",""),t.split("><")[1].replace(/<br>/g,"\n").split(">")[1]]);n.forEach((t,r)=>{e.push({id:r+1,start:t[0]/1e3,end:(n[r+1]?n[r+1][0]:t[0])/1e3,text:t[1]})});return e};class r{constructor(t,e){this.subtitle=t,this.format=e||"vtt",this.data=this._process(this.format,this.subtitle),this.videoElement,this.track}_process(r,s){switch(r){case"vtt":return t(s);case"srt":return e(s);case"smi":return n(s);default:return[]}}render(t){this.videoElement=t,this.track=this.videoElement.addTextTrack("captions"),this.track.mode="showing",Array.from(this.videoElement.textTracks).filter(t=>t!==this.track).map(t=>t.mode="hidden"),this.data.forEach(t=>this.track.addCue(new VTTCue(t.start,t.end,t.text)))}}return r});
