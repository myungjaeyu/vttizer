!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Vttizer=e()}(this,function(){"use strict";var t=t=>{let e=[];t.split("\n").slice(1).join("\n").replace(/\r+/g,"").replace(/^\s+|\s+$/g,"").split("\n\n").forEach(t=>{let n=t.split(/\n/),s=n[1].match(/(\d+):(\d+):(\d+)(?:.(\d+))?\s*--?>\s*(\d+):(\d+):(\d+)(?:.(\d+))?/);e.push({id:n[0],start:60*parseInt(s[1],10)*60+60*parseInt(s[2],10)+parseInt(s[3],10)+parseInt(s[4],10)/1e3,end:60*parseInt(s[5],10)*60+60*parseInt(s[6],10)+parseInt(s[7],10)+parseInt(s[8],10)/1e3,text:n[2]})});return e},e=t=>{let e=[];t.replace(/\r+/g,"").replace(/^\s+|\s+$/g,"").split("\n\n").forEach(t=>{let n=t.split(/\n/),s=n[1].match(/(\d+):(\d+):(\d+)(?:,(\d+))?\s*--?>\s*(\d+):(\d+):(\d+)(?:,(\d+))?/);e.push({id:n[0],start:60*parseInt(s[1],10)*60+60*parseInt(s[2],10)+parseInt(s[3],10)+parseInt(s[4],10)/1e3,end:60*parseInt(s[5],10)*60+60*parseInt(s[6],10)+parseInt(s[7],10)+parseInt(s[8],10)/1e3,text:n[2]})});return e},n=t=>{let e=[];let n=t.match(/(<SYNC[^]*?)(?=\s*<SYNC|\s*<\/BODY)/gi).map(t=>t.match(/<SYNC Start=(\d+)><P.*>(.*)?/));n.forEach((t,s)=>{e.push({id:s+1,start:t[1]/1e3,end:(n[s+1]?n[s+1][1]:t[1])/1e3,text:t[2]})});return e};class s{constructor(t,e){this.subtitle=t,this.format=e||"vtt",this.data=this._process(this.format,this.subtitle),this.videoElement,this.track}_process(s,r){switch(s){case"vtt":return t(r);case"srt":return e(r);case"smi":return n(r);default:return[]}}render(t){this.videoElement=t,this.track=this.videoElement.addTextTrack("captions"),this.track.mode="showing",Array.from(this.videoElement.textTracks).filter(t=>t!==this.track).map(t=>t.mode="hidden"),this.data.forEach(t=>this.track.addCue(new VTTCue(t.start,t.end,t.text)))}}return s});
